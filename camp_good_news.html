<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Camp Intake — Kids CRUD + Payments</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
  :root{
    --bg:#14213d;
    --panel:#1a254b;
    --text:#ffffff;
    --border:#3b4a70;
    --accent:#60a5fa;
    --ok:#22c55e;
    --danger:#ef4444;
  }
  body{
    background:linear-gradient(160deg,#14213d,#1a254b 60%,#10172a);
    color:var(--text);
    font-family:system-ui,Segoe UI,Roboto,Ubuntu,Helvetica,Arial;
  }
  h1,h2,h3,label,p,th,td,span,small,div,input,select,textarea{
    color:var(--text)!important;
  }
  .card{
    background:var(--panel);
    border:1px solid var(--border);
    box-shadow:0 0 10px #0007;
  }
  .table{
    color:var(--text);
  }
  .table thead th{
    background:#223366;
    color:#fff;
    border-bottom:2px solid var(--border);
    position:sticky;top:0;z-index:1;
  }
  .form-control,.form-select,textarea{
    background:#0f172a;
    color:#fff;
    border:1px solid #475569;
  }
  .form-control:focus,.form-select:focus{
    background:#1e293b;
    color:#fff;
    border-color:var(--accent);
    box-shadow:0 0 0 .2rem rgba(96,165,250,.25);
  }
  .btn-outline-light{
    --bs-btn-color:#fff;
    --bs-btn-border-color:#606b94;
    --bs-btn-hover-bg:#334155;
    --bs-btn-hover-border-color:#8892b0;
  }
  .btn-primary{
    background-color:var(--accent);
    border-color:var(--accent);
    color:#000;
    font-weight:600;
  }
  .btn-outline-warning{
    color:#fbbf24;
    border-color:#fbbf24;
  }
  .table-responsive{
    max-height:50vh;
    overflow:auto;
    border:1px solid var(--border);
    border-radius:.5rem;
  }
  .pill{
    font-size:.8rem;
    padding:.3rem .6rem;
    border:1px solid var(--border);
    border-radius:999px;
    background:#0f172a;
  }
  .form-check-input:checked{
    background-color:var(--ok);
    border-color:var(--ok);
  }
</style>
</head>
<body>
<div class="container py-4">
  <h1 class="h3 mb-3">Camp Intake — Kids</h1>

  <div class="row g-3">
    <div class="col-lg-5">
      <div class="card"><div class="card-body">
        <h2 class="h5 mb-2">Kid Form <span id="formMode" class="pill">Create</span></h2>
        <form id="kidForm" novalidate>
          <input type="hidden" id="kidId">

          <label class="form-label">Full Name</label>
          <input id="name" class="form-control mb-2" required>

          <div class="row g-2 mb-2">
            <div class="col-4">
              <label class="form-label">Age</label>
              <input id="age" type="number" min="5" max="18" class="form-control">
            </div>
            <div class="col-8">
              <label class="form-label">Cabin</label>
              <input id="cabin" class="form-control">
            </div>
          </div>

          <label class="form-label">Guardian</label>
          <input id="guardian" class="form-control mb-2">
          <label class="form-label">Phone</label>
          <input id="phone" class="form-control mb-2">

          <div class="row g-2 mb-2">
            <div class="col-6">
              <label class="form-label">Paid?</label>
              <select id="paid" class="form-select">
                <option value="No">No</option>
                <option value="Yes">Yes</option>
              </select>
            </div>
            <div class="col-6">
              <label class="form-label">Amount ($)</label>
              <input id="amount" type="number" min="0" class="form-control" value="0">
            </div>
          </div>

          <label class="form-label">Notes</label>
          <textarea id="notes" class="form-control mb-3" rows="3"></textarea>

          <div class="d-flex gap-2">
            <button class="btn btn-primary" type="submit" id="btnSave">Save</button>
            <button class="btn btn-outline-light" type="button" id="btnReset">Reset</button>
            <button class="btn btn-outline-warning ms-auto" type="button" id="btnCancel" hidden>Cancel Edit</button>
          </div>
        </form>
      </div></div>
    </div>

    <div class="col-lg-7">
      <div class="card"><div class="card-body">
        <div class="d-flex justify-content-between align-items-center mb-2">
          <h2 class="h5 m-0">Roster</h2>
          <input id="search" class="form-control form-control-sm" placeholder="Search">
        </div>
        <div class="table-responsive">
          <table class="table table-hover align-middle mb-0">
            <thead>
              <tr>
                <th>Name</th><th>Age</th><th>Cabin</th><th>Guardian</th><th>Paid</th><th>Amount</th><th>Actions</th>
              </tr>
            </thead>
            <tbody id="tbody"></tbody>
          </table>
        </div>
        <div class="mt-2 small d-flex justify-content-between">
          <span id="count"></span>
          <span id="total"></span>
        </div>
      </div></div>
    </div>
  </div>
</div>

<script>
const LS_KEY='camp_kids_pay';
const els={
  form:document.getElementById('kidForm'),
  id:document.getElementById('kidId'),
  name:document.getElementById('name'),
  age:document.getElementById('age'),
  cabin:document.getElementById('cabin'),
  guardian:document.getElementById('guardian'),
  phone:document.getElementById('phone'),
  paid:document.getElementById('paid'),
  amount:document.getElementById('amount'),
  notes:document.getElementById('notes'),
  tbody:document.getElementById('tbody'),
  count:document.getElementById('count'),
  total:document.getElementById('total'),
  mode:document.getElementById('formMode'),
  btnCancel:document.getElementById('btnCancel'),
  btnReset:document.getElementById('btnReset'),
  search:document.getElementById('search'),
};

function load(){return JSON.parse(localStorage.getItem(LS_KEY)||'[]')}
function save(a){localStorage.setItem(LS_KEY,JSON.stringify(a))}
function makeId(){return (Date.now().toString(36)+Math.random().toString(36).slice(2,6)).toUpperCase()}
function resetForm(){els.form.reset();els.id.value='';setMode('Create')}
function setMode(m){els.mode.textContent=m;els.btnCancel.hidden=(m!=='Edit')}
function formKid(){
  return{
    id:els.id.value||makeId(),
    name:els.name.value.trim(),
    age:Number(els.age.value)||'',
    cabin:els.cabin.value.trim(),
    guardian:els.guardian.value.trim(),
    phone:els.phone.value.trim(),
    paid:els.paid.value,
    amount:Number(els.amount.value)||0,
    notes:els.notes.value.trim()
  };
}
function render(){
  const q=els.search.value.toLowerCase();
  const arr=load().filter(k=>{
    const hay=(k.name+k.guardian+k.cabin+k.paid).toLowerCase();
    return hay.includes(q);
  });
  els.tbody.innerHTML=arr.map(k=>`
    <tr>
      <td>${k.name}</td><td>${k.age}</td><td>${k.cabin}</td>
      <td>${k.guardian}</td><td>${k.paid}</td><td>$${k.amount.toFixed(2)}</td>
      <td>
        <button class="btn btn-sm btn-outline-light" onclick="editKid('${k.id}')">Edit</button>
        <button class="btn btn-sm btn-outline-danger" onclick="delKid('${k.id}')">Del</button>
      </td>
    </tr>`).join('');
  els.count.textContent=`${arr.length} kids`;
  const totalPaid=arr.reduce((s,k)=>s+(k.paid==='Yes'?k.amount:0),0);
  els.total.textContent=`Total Collected: $${totalPaid.toFixed(2)}`;
}
function editKid(id){
  const k=load().find(x=>x.id===id);if(!k)return;
  for(const f in k){if(els[f])els[f].value=k[f]}
  els.id.value=k.id;setMode('Edit');
}
function delKid(id){
  if(confirm('Delete this kid?')){
    save(load().filter(x=>x.id!==id));render();resetForm();
  }
}
els.form.addEventListener('submit',e=>{
  e.preventDefault();
  const kid=formKid();
  const arr=load();
  const i=arr.findIndex(x=>x.id===kid.id);
  if(i>=0)arr[i]=kid;else arr.push(kid);
  save(arr);render();resetForm();
});
els.btnCancel.onclick=()=>resetForm();
els.btnReset.onclick=()=>resetForm();
els.search.oninput=render;
render();
</script>
</body>
</html>
