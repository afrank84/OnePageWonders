<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Daily Planner</title>
<style>
  :root{
    --page-w: 8.5in;
    --page-h: 11in;
    --margin: 0.5in;
    --ink: #222;
    --muted: #6b7280;
    --line: #cfd6e3;
    --accent: #4f46e5;
    --bg: #f7f9fc;
  }
  *{box-sizing:border-box}
  html,body{height:100%;background:#e9eef5}
  body{display:flex;align-items:center;justify-content:center;padding:16px;margin:0;font:14px/1.3 system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;color:var(--ink)}
  .page{
    width:var(--page-w); height:var(--page-h);
    background:linear-gradient(#f4f7fb,#eef2f9);
    border:1px solid #dde3ef; border-radius:8px;
    box-shadow:0 10px 25px rgba(30,41,59,.12);
    padding:calc(var(--margin) - .15in);
  }
  .head{display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:12px}
  .title{font-weight:700;letter-spacing:.04em;font-size:22px}
  .date{display:flex;gap:8px;align-items:center;font-size:13px;color:var(--muted)}
  .date input{
    border:none;border-bottom:2px solid var(--line);background:transparent;outline:none;
    padding:2px 4px;min-width:140px;font:inherit;color:var(--ink)
  }

  .grid{
    display:grid;
    grid-template-columns: 1.25fr .75fr;
    gap:18px;
    height:calc(100% - 58px);
  }
  .col{display:flex;flex-direction:column;gap:12px;min-height:0}

  h3{
    margin:0 0 6px 0;
    font-size:11px;
    font-weight:700;
    letter-spacing:.06em;
    color:#475569;
    text-transform:uppercase;
  }

  /* Cards */
  .card{
    background:white;border:1px solid #e5eaf4;border-radius:8px;padding:10px 12px;
    box-shadow:0 1px 0 rgba(0,0,0,.02);
  }

  /* Schedule */
  .schedule{display:flex;flex-direction:column;gap:6px;min-height:0}
  .row{
    display:grid;grid-template-columns: 60px 1fr 16px;align-items:center;gap:8px;
    padding:4px 0;
    border-bottom:1px dashed var(--line);
  }
  .row:last-child{border-bottom:none}
  .time{color:var(--muted);font-size:12px;white-space:nowrap}
  .line{height:22px;border-bottom:1px solid #ecf0f6;margin-top:-10px}
  .note-bullet{width:10px;height:10px;border:1px solid #c9d2e5;border-radius:50%}

  /* Lists */
  .checkline{
    display:grid;grid-template-columns:18px 1fr;gap:8px;align-items:center;
    padding:5px 0;border-bottom:1px dashed var(--line);
  }
  .checkline:last-child{border-bottom:none}
  input[type="checkbox"]{
    width:14px;height:14px;border:1px solid #cbd5e1;border-radius:3px;appearance:none;
    display:inline-grid;place-content:center;cursor:pointer;background:#fff;
  }
  input[type="checkbox"]:checked{background:var(--accent);border-color:var(--accent)}
  input[type="checkbox"]:checked::after{content:"✓";font-size:12px;color:white;line-height:1}

  .freewrite{
    min-height:70px;border:1px dashed var(--line);border-radius:6px;padding:8px;background:#fff
  }

  /* Make lines typeable (so JSON can store text) */
  .write-line{
    height:22px;border-bottom:1px solid #e9edf5;
  }
  .write-line[contenteditable="true"]{
    outline:none; white-space:nowrap; overflow:hidden;
  }
  .write-line[contenteditable="true"]:empty::before{
    content:"Type here";
    color:#98a2b3;
  }

  /* Controls (hidden on print) */
  .controls{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:8px}
  .btn{
    background:#ffffff;border:1px solid #d7deee;border-radius:8px;padding:8px 12px;cursor:pointer;
    font-size:13px
  }
  .btn:hover{border-color:#bcc7e6;box-shadow:0 1px 0 rgba(0,0,0,.04)}
  #fileInput{display:none}

  @media print{
    html,body{background:white}
    .page{box-shadow:none;border:none;width:auto;height:auto;padding:0;margin:0}
    .controls{display:none}
    .card{break-inside:avoid}
    .write-line[contenteditable="true"]:empty::before{content:""}
  }
</style>
</head>
<body>
  <div class="page">
    <div class="controls">
      <button class="btn" onclick="window.print()">Print / Save as PDF</button>
      <button class="btn" id="clearAll">Clear checks</button>
      <button class="btn" id="exportJson">Export JSON</button>
      <button class="btn" id="importJson">Import JSON</button>
      <input type="file" id="fileInput" accept="application/json,.json">
    </div>

    <div class="head">
      <div class="title">DAILY PLAN</div>
      <div class="date">DATE: <input id="dateField" type="date"></div>
    </div>

    <div class="grid">
      <!-- LEFT: Schedule -->
      <div class="col">
        <div class="card schedule">
          <h3>Schedule</h3>
          <div id="schedule"></div>
        </div>
      </div>

      <!-- RIGHT: Priorities / Lists / Notes -->
      <div class="col">
        <div class="card" id="workTop3">
          <h3>Top 3 Work Priorities</h3>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Work priority 1"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Work priority 2"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Work priority 3"></div></div>
        </div>

        <div class="card" id="workList">
          <h3>Work To-Do List</h3>
          <!-- 8 lines -->
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Work task 1"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Work task 2"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Work task 3"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Work task 4"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Work task 5"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Work task 6"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Work task 7"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Work task 8"></div></div>
        </div>

        <div class="card" id="personalTop3">
          <h3>Top 3 Personal Priorities</h3>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Personal priority 1"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Personal priority 2"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Personal priority 3"></div></div>
        </div>

        <div class="card" id="personalList">
          <h3>Personal To-Do List</h3>
          <!-- 8 lines -->
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Personal task 1"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Personal task 2"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Personal task 3"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Personal task 4"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Personal task 5"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Personal task 6"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Personal task 7"></div></div>
          <div class="checkline"><input type="checkbox"><div class="write-line" contenteditable="true" aria-label="Personal task 8"></div></div>
        </div>

        <div class="card">
          <h3>Notes</h3>
          <div id="notesArea" class="freewrite" contenteditable="true" aria-label="Notes area"></div>
        </div>
      </div>
    </div>
  </div>

<script>
  // Auto-fill today's date
  (function(){
    const f = document.getElementById('dateField');
    const today = new Date();
    f.value = today.toISOString().slice(0,10);
  })();

  // Build schedule 6:00 AM – 10:30 PM in 30-min increments
  (function(){
    const start = 6 * 60, end = 22 * 60 + 30;
    const wrap = document.getElementById('schedule');
    for(let m = start; m <= end; m += 30){
      const h = Math.floor(m/60), mm = m%60;
      const ampm = h < 12 ? 'am' : 'pm';
      const hh = ((h+11)%12)+1;
      const label = `${hh}:${mm.toString().padStart(2,'0')} ${ampm}`;

      const row = document.createElement('div');
      row.className = 'row';
      row.innerHTML = `
        <div class="time">${label}</div>
        <div class="line"></div>
        <div class="note-bullet" aria-hidden="true"></div>
      `;
      wrap.appendChild(row);
    }
  })();

  // Clear all checkboxes
  document.getElementById('clearAll').addEventListener('click', ()=>{
    document.querySelectorAll('input[type="checkbox"]').forEach(c=>c.checked=false);
  });

  // ------- JSON Import/Export -------
  const $ = (s, root=document) => root.querySelector(s);
  const $$ = (s, root=document) => Array.from(root.querySelectorAll(s));

  function readList(containerId){
    return $$('#'+containerId+' .checkline').map(line=>{
      const cb = $('input[type="checkbox"]', line);
      const txt = $('.write-line', line);
      return { checked: !!cb.checked, text: (txt.innerText || '').trim() };
    });
  }

  function populateList(containerId, arr){
    const lines = $$('#'+containerId+' .checkline');
    for(let i=0;i<lines.length;i++){
      const cb = $('input[type="checkbox"]', lines[i]);
      const txt = $('.write-line', lines[i]);
      const item = arr && arr[i] ? arr[i] : {};
      cb.checked = !!item.checked;
      txt.innerText = item.text || '';
    }
  }

  function exportJSON(){
    const data = {
      version: 1,
      generatedAt: new Date().toISOString(),
      date: $('#dateField').value,
      sections: {
        workTop3: readList('workTop3'),
        workList: readList('workList'),
        personalTop3: readList('personalTop3'),
        personalList: readList('personalList')
      },
      notesHtml: $('#notesArea').innerHTML
    };

    const blob = new Blob([JSON.stringify(data, null, 2)], {type:'application/json'});
    const a = document.createElement('a');
    const fname = `daily-plan-${data.date || new Date().toISOString().slice(0,10)}.json`;
    a.href = URL.createObjectURL(blob);
    a.download = fname;
    document.body.appendChild(a);
    a.click();
    URL.revokeObjectURL(a.href);
    a.remove();
  }

  function importJSONFile(file){
    const reader = new FileReader();
    reader.onload = (e)=>{
      try{
        const data = JSON.parse(e.target.result);
        if(data.date) $('#dateField').value = data.date;
        if(data.sections){
          populateList('workTop3', data.sections.workTop3);
          populateList('workList', data.sections.workList);
          populateList('personalTop3', data.sections.personalTop3);
          populateList('personalList', data.sections.personalList);
        }
        if(typeof data.notesHtml === 'string'){
          $('#notesArea').innerHTML = data.notesHtml;
        }
        alert('Plan loaded successfully.');
      }catch(err){
        console.error(err);
        alert('Invalid JSON file.');
      }
    };
    reader.readAsText(file);
  }

  $('#exportJson').addEventListener('click', exportJSON);
  $('#importJson').addEventListener('click', ()=> $('#fileInput').click());
  $('#fileInput').addEventListener('change', (e)=>{
    const file = e.target.files && e.target.files[0];
    if(file) importJSONFile(file);
    e.target.value = ''; // reset so same file can be chosen again later
  });

  // Optional: keep single-line behavior in contenteditable (prevent Enter from adding new lines)
  document.addEventListener('keydown', (e)=>{
    if(e.target.matches('.write-line[contenteditable="true"]') && e.key === 'Enter'){
      e.preventDefault();
      e.target.blur();
    }
  });
</script>
</body>
</html>
